# Bitchat TCP Server

Серверная часть для TCP mesh chat функциональности Bitchat приложения.

## Описание

Этот сервер обеспечивает централизованную координацию TCP mesh сети для клиентов Bitchat Android. Сервер может работать как relay для сообщений между клиентами, которые не могут установить прямое P2P соединение.

## Возможности

- **Ретрансляция сообщений**: Перенаправляет сообщения между подключенными клиентами
- **Управление каналами**: Поддерживает создание и управление каналами чата
- **Совместимость с протоколом**: Использует тот же бинарный протокол, что и Bluetooth mesh
- **Безопасность**: Ретранслирует зашифрованные сообщения без расшифровки
- **Масштабируемость**: Поддерживает множественные одновременные подключения

## Требования

- Java 17 или выше
- Kotlin 1.8+
- Открытый порт для TCP соединений (по умолчанию 9090)

## Установка и запуск

### Компиляция
```bash
kotlinc BitchatTcpServer.kt -include-runtime -d bitchat-server.jar
```

### Запуск
```bash
java -jar bitchat-server.jar [port]
```

По умолчанию сервер запускается на порту 9090.

### Запуск из исходного кода
```bash
kotlin BitchatTcpServer.kt [port]
```

## Конфигурация

### Переменные окружения

- `BITCHAT_SERVER_PORT` - порт сервера (по умолчанию 9090)
- `BITCHAT_MAX_CLIENTS` - максимальное количество клиентов (по умолчанию 1000)
- `BITCHAT_MESSAGE_HISTORY` - количество сообщений в истории канала (по умолчанию 100)

### Аргументы командной строки

```bash
kotlin BitchatTcpServer.kt --port 9090 --max-clients 1000 --debug
```

## Протокол

Сервер использует тот же бинарный протокол, что и Bitchat Android приложение:

- Совместимость с существующим форматом сообщений
- Поддержка шифрования X25519 + AES-256-GCM
- Команды в стиле IRC (/join, /msg, /who)
- TTL и маршрутизация сообщений

## Развертывание

### Docker
```dockerfile
FROM openjdk:17-alpine
COPY bitchat-server.jar /app/
EXPOSE 9090
CMD ["java", "-jar", "/app/bitchat-server.jar"]
```

### Systemd Service
```ini
[Unit]
Description=Bitchat TCP Server
After=network.target

[Service]
Type=simple
User=bitchat
ExecStart=/usr/bin/java -jar /opt/bitchat/server.jar
Restart=always

[Install]
WantedBy=multi-user.target
```

### Cloud Deployment

Сервер может быть развернут на любом облачном провайдере:
- AWS EC2
- Google Cloud Compute
- DigitalOcean Droplet
- Heroku
- Railway

## Мониторинг

Сервер предоставляет базовую статистику:
- Количество подключенных клиентов
- Активные каналы
- Статистика сообщений
- Время работы сервера

## Безопасность

- Сервер не расшифровывает сообщения клиентов
- Все E2E шифрование сохраняется
- Рекомендуется использовать HTTPS/TLS для продакшн развертывания
- Базовая защита от DDoS атак

## Лицензия

Этот проект выпущен в общественное достояние. См. файл LICENSE для деталей.